<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¤©æ°—äºˆå ± â€” tkegg</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Noto+Sans+JP:wght@300;400;700&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --bg: #fafaf8;
  --surface: #f3f2ee;
  --card: #ffffff;
  --border: #e8e6e0;
  --ink: #1a1a18;
  --muted: #888880;
  --accent: #2563eb;
  --accent2: #059669;
  --mono: 'DM Mono', monospace;
}
body {
  background: var(--bg);
  color: var(--ink);
  font-family: 'Noto Sans JP', sans-serif;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
.container { max-width: 660px; margin: 0 auto; padding: 0 1.5rem; width: 100%; }

/* NAV */
nav { border-bottom: 1px solid var(--border); padding: 1rem 0; }
.nav-inner { display: flex; align-items: center; justify-content: space-between; }
.nav-logo { font-family: var(--mono); font-size: 0.78rem; color: var(--muted); text-decoration: none; transition: color 0.2s; }
.nav-logo:hover { color: var(--ink); }
.nav-back { font-family: var(--mono); font-size: 0.68rem; color: var(--muted); text-decoration: none; display: flex; align-items: center; gap: 0.3rem; transition: color 0.2s; }
.nav-back:hover { color: var(--ink); }

/* MAIN */
main { flex: 1; padding: 3rem 0; }

.page-eyebrow { font-family: var(--mono); font-size: 0.62rem; color: var(--muted); letter-spacing: 0.18em; text-transform: uppercase; margin-bottom: 0.8rem; }
.page-title { font-family: 'Instrument Serif', serif; font-size: 2.4rem; font-weight: 400; letter-spacing: -0.02em; margin-bottom: 0.5rem; }
.page-title em { font-style: italic; color: var(--muted); }
.page-desc { font-size: 0.82rem; color: var(--muted); line-height: 1.7; margin-bottom: 2rem; }

/* LOCATION BAR */
.location-bar {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 0.7rem 1rem;
  margin-bottom: 1.5rem;
  font-family: var(--mono);
  font-size: 0.72rem;
  color: var(--muted);
}
.location-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--accent2);
  animation: blink 2.5s ease-in-out infinite;
  flex-shrink: 0;
}
@keyframes blink {
  0%,100% { opacity: 1; }
  50% { opacity: 0.3; }
}
.location-name { color: var(--ink); font-weight: 500; }
.location-updated { margin-left: auto; }

/* TODAY CARD */
.today-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 2rem 1.8rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 1.5rem;
  animation: fadeUp 0.5s ease;
}
@keyframes fadeUp { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

.today-emoji { font-size: 4rem; line-height: 1; }
.today-body { flex: 1; }
.today-label { font-family: var(--mono); font-size: 0.6rem; color: var(--muted); letter-spacing: 0.12em; text-transform: uppercase; margin-bottom: 0.3rem; }
.today-temp {
  font-family: 'Instrument Serif', serif;
  font-size: 3.5rem;
  font-weight: 400;
  letter-spacing: -0.03em;
  line-height: 1;
  margin-bottom: 0.4rem;
}
.today-temp sup { font-size: 1.5rem; color: var(--muted); }
.today-condition { font-size: 0.88rem; color: var(--muted); margin-bottom: 0.8rem; }
.today-meta {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}
.today-meta-item {
  display: flex;
  align-items: center;
  gap: 0.35rem;
  font-family: var(--mono);
  font-size: 0.65rem;
  color: var(--muted);
}

/* FORECAST */
.forecast-label {
  font-family: var(--mono);
  font-size: 0.62rem;
  color: var(--muted);
  letter-spacing: 0.18em;
  text-transform: uppercase;
  margin: 1.5rem 0 0.8rem;
  display: flex;
  align-items: center;
  gap: 0.8rem;
}
.forecast-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }

.forecast-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.7rem;
}
.forecast-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 1.1rem 1rem;
  text-align: center;
  transition: all 0.18s;
  animation: fadeUp 0.5s ease;
}
.forecast-card:hover { border-color: var(--ink); transform: translateY(-2px); box-shadow: 0 4px 16px rgba(0,0,0,0.06); }
.forecast-day { font-family: var(--mono); font-size: 0.62rem; color: var(--muted); letter-spacing: 0.08em; margin-bottom: 0.6rem; }
.forecast-emoji { font-size: 1.8rem; margin-bottom: 0.5rem; }
.forecast-temp { font-family: 'Instrument Serif', serif; font-size: 1.4rem; font-weight: 400; }
.forecast-temp-sub { font-size: 0.7rem; color: var(--muted); margin-top: 0.2rem; }
.forecast-cond { font-size: 0.68rem; color: var(--muted); margin-top: 0.4rem; line-height: 1.4; }

/* LOADING / ERROR */
.status-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 2rem;
  text-align: center;
  font-family: var(--mono);
  font-size: 0.72rem;
  color: var(--muted);
}
.loading-dot {
  display: inline-block;
  animation: loadDot 1.2s ease-in-out infinite;
}
.loading-dot:nth-child(2) { animation-delay: 0.2s; }
.loading-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes loadDot { 0%,80%,100%{opacity:0.2} 40%{opacity:1} }

/* FOOTER */
footer { border-top: 1px solid var(--border); padding: 1rem 0; margin-top: auto; }
.footer-inner { display: flex; align-items: center; justify-content: space-between; }
.footer-text { font-family: var(--mono); font-size: 0.6rem; color: var(--muted); }
</style>
</head>
<body>

<nav>
  <div class="container">
    <div class="nav-inner">
      <a href="index.html" class="nav-logo">tkegg / portfolio</a>
      <a href="index.html" class="nav-back">â† æˆ»ã‚‹</a>
    </div>
  </div>
</nav>

<main>
  <div class="container">
    <div class="page-eyebrow">Weather Forecast</div>
    <h1 class="page-title">å¤©æ°—äºˆå ±<em>ï¼ˆæ±äº¬ï¼‰</em></h1>
    <p class="page-desc">Open-Meteo APIã‚’ä½¿ã£ã¦æ±äº¬ã®å¤©æ°—ã‚’å–å¾—ãƒ»è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚<br>APIã‚­ãƒ¼ä¸è¦ãƒ»å®Œå…¨ç„¡æ–™ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ´»ç”¨ã—ã¾ã—ãŸã€‚</p>

    <div class="location-bar">
      <div class="location-dot"></div>
      <span class="location-name">æ±äº¬éƒ½</span>
      <span>35.6895Â°N, 139.6917Â°E</span>
      <span class="location-updated" id="updatedAt">å–å¾—ä¸­â€¦</span>
    </div>

    <div id="weatherContainer">
      <div class="status-card">
        <div style="font-size:1.5rem;margin-bottom:0.5rem;">âŸ³</div>
        å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­
        <span class="loading-dot">.</span><span class="loading-dot">.</span><span class="loading-dot">.</span>
      </div>
    </div>

  </div>
</main>

<footer>
  <div class="container">
    <div class="footer-inner">
      <div class="footer-text">Â© 2025 tkegg</div>
      <div class="footer-text">Powered by Open-Meteo API</div>
    </div>
  </div>
</footer>

<script>
const WMO = {
  0:  { label: 'å¿«æ™´',     emoji: 'â˜€ï¸' },
  1:  { label: 'æ™´ã‚Œ',     emoji: 'ğŸŒ¤ï¸' },
  2:  { label: 'ä¸€éƒ¨æ›‡ã‚Š', emoji: 'â›…' },
  3:  { label: 'æ›‡ã‚Š',     emoji: 'â˜ï¸' },
  45: { label: 'éœ§',       emoji: 'ğŸŒ«ï¸' },
  48: { label: 'éœ§æ°·',     emoji: 'ğŸŒ«ï¸' },
  51: { label: 'éœ§é›¨',     emoji: 'ğŸŒ¦ï¸' },
  53: { label: 'éœ§é›¨',     emoji: 'ğŸŒ¦ï¸' },
  55: { label: 'å¼·ã„éœ§é›¨', emoji: 'ğŸŒ¦ï¸' },
  61: { label: 'å°é›¨',     emoji: 'ğŸŒ§ï¸' },
  63: { label: 'é›¨',       emoji: 'ğŸŒ§ï¸' },
  65: { label: 'å¤§é›¨',     emoji: 'ğŸŒ§ï¸' },
  71: { label: 'å°é›ª',     emoji: 'ğŸŒ¨ï¸' },
  73: { label: 'é›ª',       emoji: 'â„ï¸' },
  75: { label: 'å¤§é›ª',     emoji: 'â„ï¸' },
  80: { label: 'ã«ã‚ã‹é›¨', emoji: 'ğŸŒ¦ï¸' },
  81: { label: 'ã«ã‚ã‹é›¨', emoji: 'ğŸŒ¦ï¸' },
  82: { label: 'æ¿€ã—ã„é›¨', emoji: 'â›ˆï¸' },
  95: { label: 'é›·é›¨',     emoji: 'â›ˆï¸' },
  99: { label: 'æ¿€ã—ã„é›·', emoji: 'â›ˆï¸' },
};

function getWeather(code) {
  return WMO[code] || { label: 'ä¸æ˜', emoji: 'ğŸŒ¡ï¸' };
}

function getDayLabel(dateStr, index) {
  if (index === 0) return 'ä»Šæ—¥';
  if (index === 1) return 'æ˜æ—¥';
  const d = new Date(dateStr);
  return ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'][d.getDay()] + 'æ›œæ—¥';
}

async function fetchWeather() {
  try {
    const url = 'https://api.open-meteo.com/v1/forecast?latitude=35.6895&longitude=139.6917&current=temperature_2m,weathercode,windspeed_10m,relativehumidity_2m&daily=weathercode,temperature_2m_max,temperature_2m_min&timezone=Asia/Tokyo&forecast_days=3';
    const res = await fetch(url);
    const data = await res.json();

    const now = new Date();
    document.getElementById('updatedAt').textContent =
      `æ›´æ–°: ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;

    const cur = data.current;
    const daily = data.daily;
    const todayWeather = getWeather(cur.weathercode);

    const container = document.getElementById('weatherContainer');
    container.innerHTML = `
      <div class="today-card">
        <div class="today-emoji">${todayWeather.emoji}</div>
        <div class="today-body">
          <div class="today-label">ç¾åœ¨ã®å¤©æ°—</div>
          <div class="today-temp">${Math.round(cur.temperature_2m)}<sup>Â°C</sup></div>
          <div class="today-condition">${todayWeather.label}</div>
          <div class="today-meta">
            <div class="today-meta-item">ğŸ’§ æ¹¿åº¦ ${cur.relativehumidity_2m}%</div>
            <div class="today-meta-item">ğŸ’¨ é¢¨é€Ÿ ${cur.windspeed_10m} km/h</div>
            <div class="today-meta-item">ğŸŒ¡ï¸ æœ€é«˜ ${Math.round(daily.temperature_2m_max[0])}Â°C</div>
            <div class="today-meta-item">â„ï¸ æœ€ä½ ${Math.round(daily.temperature_2m_min[0])}Â°C</div>
          </div>
        </div>
      </div>

      <div class="forecast-label">3æ—¥é–“ã®äºˆå ±</div>
      <div class="forecast-grid">
        ${daily.time.map((date, i) => {
          const w = getWeather(daily.weathercode[i]);
          return `
            <div class="forecast-card">
              <div class="forecast-day">${getDayLabel(date, i)}</div>
              <div class="forecast-emoji">${w.emoji}</div>
              <div class="forecast-temp">${Math.round(daily.temperature_2m_max[i])}Â°</div>
              <div class="forecast-temp-sub">${Math.round(daily.temperature_2m_min[i])}Â° / ${Math.round(daily.temperature_2m_max[i])}Â°</div>
              <div class="forecast-cond">${w.label}</div>
            </div>
          `;
        }).join('')}
      </div>
    `;
  } catch (err) {
    document.getElementById('weatherContainer').innerHTML = `
      <div class="status-card">
        âš ï¸ ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<br>
        <span style="font-size:0.62rem;margin-top:0.4rem;display:block;">ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</span>
      </div>
    `;
  }
}

fetchWeather();
</script>
</body>
</html>
